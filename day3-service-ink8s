#we will see how to expose my application inside and outside k8s cluster 
   189  kubectl expose deploy -h
  #we will expose the deployment using clusterip which willl expose my application internal to your k8s cluster
  190  kubectl expose deploy my-first-deployment --type=ClusterIP --name=my-first-cluster-service
  #get svc will give me the name of the service which we have created 
  191  kubectl get svc
  #lets create a dnspod 
  kubectl apply -f https://k8s.io/examples/admin/dns/dnsutils.yaml
#from the dns pod if we try to look into the service 

#it will show the ip address of one of the pod
  196  kubectl exec -i -t dnsutils -- nslookup my-first-cluster-service.default
  #but if we do curl request you will see the test page of nginx
  197  kubectl exec -i -t dnsutils -- curl my-first-cluster-service.default

  #lets expose the same application using node port 
  [root@ip-172-31-93-226 ~]$  kubectl expose deploy my-first-deployment --type=NodePort --name=myfirst-node-service
service/myfirst-node-service exposed
  #once you expose it you will see a port number on 30000 series
[root@ip-172-31-93-226 ~]$ kubectl get svc
NAME                       TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
kubernetes                 ClusterIP   10.96.0.1        <none>        443/TCP        22h
my-first-cluster-service   ClusterIP   10.106.73.127    <none>        80/TCP         6m14s
myfirst-node-service       NodePort    10.111.153.110   <none>        80:31385/TCP   4s

#you need to copy your nodemachine dns name: port number
  like this 
  http://lab-as-23518.lc.cl-labs.springpeople.com:31385/
  ##it will show the test page of nginx
  #check the ip address of all the pod
   201  kubectl get pod -o wide
  202  kubectl get svc
  #when you describe the svc you will see that svc is pointing towards all the pod ip address
  203  kubectl describe svc myfirst-node-service
#lets update the deployment with a new image
[root@ip-172-31-93-226 ~]$ kubectl set image deployment my-first-deployment myapp=nulldevil/phpsysinfo
deployment.apps/my-first-deployment image updated
####lets check the deployment 
[root@ip-172-31-93-226 ~]$ kubectl get deploy
NAME                  READY   UP-TO-DATE   AVAILABLE   AGE
my-first-deployment   5/5     5            5           147m

#####lets check the rs
[root@ip-172-31-93-226 ~]$ kubectl get rs
NAME                             DESIRED   CURRENT   READY   AGE
my-first-deployment-5d6b777b8    0         0         0       148m
my-first-deployment-6544c8c8cc   5         5         5       64s
##lets describe the deployment 
  216  kubectl describe deploy my-first-deployment
??????#lets check the rollout history
218  kubectl rollout history deploy my-first-deployment
#lets check what is there in the revision 1 and in revision 2
  219  kubectl rollout history deploy my-first-deployment --revision=1
  220  kubectl rollout history deploy my-first-deployment --revision=2
#if you want to go to previous version
 218  kubectl rollout history deploy my-first-deployment
  219  kubectl rollout history deploy my-first-deployment --revision=1
  220  kubectl rollout history deploy my-first-deployment --revision=2
  221  history
  222  kubectl describe deploy my-first-deployment
  223  kubectl get pod -o wide
  224  kubectl rollout undo deployment my-first-deployment --to-revision=1
  225  kubectl describe deploy my-first-deployment
  226  history

